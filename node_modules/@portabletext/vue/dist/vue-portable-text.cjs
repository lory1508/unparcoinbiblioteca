"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const p=require("vue");function D(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),t.push.apply(t,r)}return t}function B(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?D(Object(t),!0).forEach(function(r){q(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):D(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function q(e,n,t){return(n=F(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function F(e){var n=H(e,"string");return typeof n=="symbol"?n:n+""}function H(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function T(e){return e._type==="span"&&"text"in e&&typeof e.text=="string"&&(typeof e.marks>"u"||Array.isArray(e.marks)&&e.marks.every(n=>typeof n=="string"))}function L(e){return typeof e._type=="string"&&e._type[0]!=="@"&&(!("markDefs"in e)||!e.markDefs||Array.isArray(e.markDefs)&&e.markDefs.every(n=>typeof n._key=="string"))&&"children"in e&&Array.isArray(e.children)&&e.children.every(n=>typeof n=="object"&&"_type"in n)}function A(e){return L(e)&&"listItem"in e&&typeof e.listItem=="string"&&(typeof e.level>"u"||typeof e.level=="number")}function E(e){return e._type==="@list"}function N(e){return e._type==="@span"}function U(e){return e._type==="@text"}const j=["strong","em","code","underline","strike-through"];function R(e,n,t){if(!T(e)||!e.marks)return[];if(!e.marks.length)return[];const r=e.marks.slice(),o={};return r.forEach(i=>{o[i]=1;for(let c=n+1;c<t.length;c++){const a=t[c];if(a&&T(a)&&Array.isArray(a.marks)&&a.marks.indexOf(i)!==-1)o[i]++;else break}}),r.sort((i,c)=>z(o,i,c))}function z(e,n,t){const r=e[n],o=e[t];if(r!==o)return o-r;const i=j.indexOf(n),c=j.indexOf(t);return i!==c?i-c:n.localeCompare(t)}function V(e){var n,t;const{children:r}=e,o=(n=e.markDefs)!=null?n:[];if(!r||!r.length)return[];const i=r.map(R),c={_type:"@span",children:[],markType:"<unknown>"};let a=[c];for(let b=0;b<r.length;b++){const _=r[b];if(!_)continue;const w=i[b]||[];let l=1;if(a.length>1)for(l;l<a.length;l++){const u=((t=a[l])==null?void 0:t.markKey)||"",f=w.indexOf(u);if(f===-1)break;w.splice(f,1)}a=a.slice(0,l);let s=a[a.length-1];if(s){for(const u of w){const f=o==null?void 0:o.find(m=>m._key===u),y=f?f._type:u,d={_type:"@span",_key:_._key,children:[],markDef:f,markType:y,markKey:u};s.children.push(d),a.push(d),s=d}if(T(_)){const u=_.text.split(`
`);for(let f=u.length;f-- >1;)u.splice(f,0,`
`);s.children=s.children.concat(u.map(f=>({_type:"@text",text:f})))}else s.children=s.children.concat(_)}}return c.children}function G(e,n){const t=[];let r;for(let o=0;o<e.length;o++){const i=e[o];if(i){if(!A(i)){t.push(i),r=void 0;continue}if(!r){r=O(i,o,n),t.push(r);continue}if(J(i,r)){r.children.push(i);continue}if((i.level||1)>r.level){const c=O(i,o,n);if(n==="html"){const a=r.children[r.children.length-1],b=B(B({},a),{},{children:[...a.children,c]});r.children[r.children.length-1]=b}else r.children.push(c);r=c;continue}if((i.level||1)<r.level){const c=t[t.length-1],a=c&&P(c,i);if(a){r=a,r.children.push(i);continue}r=O(i,o,n),t.push(r);continue}if(i.listItem!==r.listItem){const c=t[t.length-1],a=c&&P(c,{level:i.level||1});if(a&&a.listItem===i.listItem){r=a,r.children.push(i);continue}else{r=O(i,o,n),t.push(r);continue}}console.warn("Unknown state encountered for block",i),t.push(i)}}return t}function J(e,n){return(e.level||1)===n.level&&e.listItem===n.listItem}function O(e,n,t){return{_type:"@list",_key:`${e._key||`${n}`}-parent`,mode:t,level:e.level||1,listItem:e.listItem,children:[e]}}function P(e,n){const t=n.level||1,r=n.listItem||"normal",o=typeof n.listItem=="string";if(E(e)&&(e.level||1)===t&&o&&(e.listItem||"normal")===r)return e;if(!("children"in e))return;const i=e.children[e.children.length-1];return i&&!T(i)?P(i,n):void 0}function C(e){let n="";return e.children.forEach(t=>{U(t)?n+=t.text:N(t)&&(n+=C(t))}),n}const Q=/^\s/,X=/\s$/;function Y(e){const n=Array.isArray(e)?e:[e];let t="";return n.forEach((r,o)=>{if(!L(r))return;let i=!1;r.children.forEach(c=>{T(c)?(t+=i&&t&&!X.test(t)&&!Q.test(c.text)?" ":"",t+=c.text,i=!1):i=!0}),o!==n.length-1&&(t+=`

`)}),t}const Z="html";function K(e,n){const{block:t,list:r,listItem:o,marks:i,types:c,...a}=n;return{...e,block:I(e,n,"block"),list:I(e,n,"list"),listItem:I(e,n,"listItem"),marks:I(e,n,"marks"),types:I(e,n,"types"),...a}}function I(e,n,t){const r=n[t],o=e[t];return typeof r=="function"||r&&typeof o=="function"?r:r?{...o,...r}:o}const k=e=>(n,{slots:t})=>{var r;return p.h(e,(r=t.default)==null?void 0:r.call(t))},ee=({value:e},{slots:n})=>{var t;return p.h("a",{href:e==null?void 0:e.href},(t=n.default)==null?void 0:t.call(n))},te={textDecoration:"underline"},ne={code:k("code"),em:k("em"),link:ee,"strike-through":k("del"),strong:k("strong"),underline:(e,{slots:n})=>{var t;return p.h("span",{style:te},(t=n.default)==null?void 0:t.call(n))}},re={number:k("ol"),bullet:k("ul")},ie=k("li"),x=(e,n)=>`[@portabletext/vue] Unknown ${e}, specify a component for it in the \`components.${n}\` prop`,W=e=>x(`block type "${e}"`,"types"),le=e=>x(`mark type "${e}"`,"marks"),oe=e=>x(`block style "${e}"`,"block"),se=e=>x(`list style "${e}"`,"list"),ce=e=>x(`list item style "${e}"`,"listItem");function ue(e){console.warn(e)}const M={display:"none"},ae=({value:e,isInline:n})=>{const t=W(e._type);return n?p.h("span",{style:M},t):p.h("div",{style:M},t)},fe=({markType:e},{slots:n})=>{var t;return p.h("span",{class:`unknown__pt__mark__${e}`},(t=n.default)==null?void 0:t.call(n))},ye=k("p"),pe=k("ul"),ke=k("li"),he=()=>p.h("br"),de={normal:k("p"),blockquote:k("blockquote"),h1:k("h1"),h2:k("h2"),h3:k("h3"),h4:k("h4"),h5:k("h5"),h6:k("h6")},S={types:{},block:de,marks:ne,list:re,listItem:ie,hardBreak:he,unknownType:ae,unknownMark:fe,unknownList:pe,unknownListItem:ke,unknownBlockStyle:ye},me=(e,n=!1)=>t=>{if(n){const{value:r,...o}=t;return p.h(e,{...o,...r})}return p.h(e,{...t.value})},be=(e,n)=>{function t(l){const{node:s,index:u,isInline:f}=l,y=s._key||`node-${u}`;return E(s)?i(s,u,y):A(s)?o(s,u,y):N(s)?c(s,u,y):r(s)?w(s,u,y,f):L(s)?a(s,u,y,f):U(s)?b(s,y):_(s,u,y,f)}function r(l){return l._type in e.types}function o(l,s,u){const f=$({node:l,index:s,isInline:!1,renderNode:t}),y=e.listItem,m=(typeof y=="function"?y:y[l.listItem])||e.unknownListItem;if(m===e.unknownListItem){const g=l.listItem||"bullet";n(ce(g),{type:g,nodeType:"listItemStyle"})}let h=f.children;if(l.style&&l.style!=="normal"){const{listItem:g,...v}=l;h=t({node:v,index:s,isInline:!1,renderNode:t})}return p.h(m,{key:u,value:l,index:s,isInline:!1,renderNode:t},()=>h)}function i(l,s,u){const f=l.children.map((h,g)=>t({node:h._key?h:{...h,_key:`li-${s}-${g}`},index:g,isInline:!1,renderNode:t})),y=e.list,m=(typeof y=="function"?y:y[l.listItem])||e.unknownList;if(m===e.unknownList){const h=l.listItem||"bullet";n(se(h),{nodeType:"listStyle",type:h})}return p.h(m,{key:u,value:l,index:s,isInline:!1,renderNode:t},()=>f)}function c(l,s,u){const{markDef:f,markType:y,markKey:d}=l,m=e.marks[y]||e.unknownMark,h=l.children.map((g,v)=>t({node:g,index:v,isInline:!0,renderNode:t}));return m===e.unknownMark&&n(le(y),{nodeType:"mark",type:y}),p.h(m,{key:u,text:C(l),value:f,markType:y,markKey:d,renderNode:t},()=>h)}function a(l,s,u,f){const{_key:y,children:d,...m}=$({node:l,index:s,isInline:f,renderNode:t}),h=m.node.style||"normal",v=(typeof e.block=="function"?e.block:e.block[h])||e.unknownBlockStyle;return v===e.unknownBlockStyle&&n(oe(h),{nodeType:"blockStyle",type:h}),p.h(v,{key:u,...m,value:m.node,renderNode:t},()=>d)}function b(l,s){if(l.text===`
`){const u=e.hardBreak;return u?p.h(u,{key:s}):`
`}return l.text}function _(l,s,u,f){const y={value:l,isInline:f,index:s,renderNode:t};n(W(l._type),{nodeType:"block",type:l._type});const d=e.unknownType;return p.h(d,{key:u,...y})}function w(l,s,u,f){const y={value:l,isInline:f,index:s,renderNode:t},d=e.types[l._type];return d?p.h(d,{key:u,...y}):void 0}return t};function $(e){const{node:n,index:t,isInline:r,renderNode:o}=e,c=V(n).map((a,b)=>o({node:a,isInline:!0,index:b,renderNode:o}));return{_key:n._key||`block-${t}`,children:c,index:t,isInline:r,node:n}}const ge=p.defineComponent({__name:"vue-portable-text",props:{value:{},components:{},onMissingComponent:{type:[Function,Boolean],default:()=>ue},listNestingMode:{}},setup(e){function n(){}const t=e,r=()=>{const o=t.onMissingComponent||n,i=Array.isArray(t.value)?t.value:[t.value],c=G(i,t.listNestingMode||Z),a=t.components?K(S,t.components):S,b=be(a,o);return c.map((w,l)=>b({node:w,index:l,isInline:!1,renderNode:b}))};return(o,i)=>(p.openBlock(),p.createBlock(r))}});exports.PortableText=ge;exports.defaultComponents=S;exports.flattenProps=me;exports.mergeComponents=K;exports.toPlainText=Y;
